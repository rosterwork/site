<!doctype html>
<html lang="pt-BR">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>RosterWork - Main</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@100;200;300;400;500;600;700;800;900&display=block" rel="stylesheet">
    <link rel="stylesheet" href="css/main.css">
    <link rel="stylesheet" href="css/confirmacaoSair.css">
  </head>
  <body>
    <div class="cabecalho">
      <div class="cabecalhoEsquerdo">
        <img class="logo" src="svg/logo.svg" alt="RosterWork">
        <div class="cabecalhoEsquerda">
          <h1 class="cabecalhoTitulo">Corpo de Bombeiros do Paraná</h1>
        </div>
      </div>
      <div class="cabecalhoDireito">
        <div class="cabecalhoDireita">
          <div class="cabecalhoDireitaBox cabecalhoDireitaBox1">4ºCRBM / 2ªCIBM / 1ºPEL</div>
          <div class="cabecalhoDireitaBox cabecalhoDireitaBox2">Cb. Henry</div>
          <div class="cabecalhoDireitaBox cabecalhoDireitaBox3">Administrador</div>
        </div>
        <div class="cabecalhoBotoes">
          <button class="botaoCabecalho">
            <img src="svg/engrenagem.svg" alt="Engrenagem" width="20" height="20" style="display:block;">
          </button>
          <button class="botaoCabecalho" onclick="mostrarConfirmacaoSairLogout()">
            <img src="svg/logout.svg" alt="Logout" width="20" height="20" style="display:block;">
          </button>
        </div>
      </div>
    </div>

    <div class="layoutConteudo">
      <div class="menuLateral" id="menuLateral">
        <button class="botaoMenu" aria-label="Menu" onclick="alternarMenu()">
          <img src="svg/menu.svg" alt="Menu" width="20" height="20" style="display:block;">
        </button>
        
        <nav class="navegacaoMenu">
          <div class="itemMenu">
            <button class="botaoItemMenu" onclick="alternarSubmenu('visualizar')">
              <span>VISUALIZAR</span>
              <img class="seta" src="svg/seta.svg" alt="Seta" width="12" height="12" style="display:block;">
            </button>
            <div class="submenu" id="submenu-visualizar">
              <button class="itemSubmenu" onclick="selecionarItemMenu('Escalas de serviço', 'visualizar', 'Escalas de serviço')">Escalas de serviço</button>
              <button class="itemSubmenu" onclick="selecionarItemMenu('Escalas de extrajornada', 'visualizar', 'Escalas de extrajornada')">Escalas de extrajornada</button>
              <button class="itemSubmenu" onclick="selecionarItemMenu('Efetivo', 'visualizar', 'Efetivo')">Efetivo</button>
              <button class="itemSubmenu" onclick="selecionarItemMenu('Guarnições', 'visualizar', 'Guarnições')">Guarnições</button>
              <button class="itemSubmenu" onclick="selecionarItemMenu('Viaturas', 'visualizar', 'Viaturas')">Viaturas</button>
              <button class="itemSubmenu" onclick="alternarSubmenu('alteracoes')">
                <span>Alterações</span>
                <img class="seta" src="svg/seta.svg" alt="Seta" width="12" height="12" style="display:block;">
              </button>
              <div class="submenu" id="submenu-alteracoes">
                <button class="itemSubmenu itemSubmenuNivel2" onclick="selecionarItemMenu('Trocas de serviço', 'visualizar', 'alteracoes', 'Trocas de serviço')">Trocas de serviço</button>
                <button class="itemSubmenu itemSubmenuNivel2" onclick="selecionarItemMenu('Folgas', 'visualizar', 'alteracoes', 'Folgas')">Folgas</button>
                <button class="itemSubmenu itemSubmenuNivel2" onclick="selecionarItemMenu('Férias', 'visualizar', 'alteracoes', 'Férias')">Férias</button>
                <button class="itemSubmenu itemSubmenuNivel2" onclick="selecionarItemMenu('Atestados', 'visualizar', 'alteracoes', 'Atestados')">Atestados</button>
              </div>
            </div>
          </div>

          <div class="itemMenu">
            <button class="botaoItemMenu" onclick="alternarSubmenu('solicitar')">
              <span>SOLICITAR</span>
              <img class="seta" src="svg/seta.svg" alt="Seta" width="12" height="12" style="display:block;">
            </button>
            <div class="submenu" id="submenu-solicitar">
              <button class="itemSubmenu" onclick="selecionarItemMenu('Troca de serviço', 'solicitar', 'Troca de serviço')">Troca de serviço</button>
              <button class="itemSubmenu" onclick="selecionarItemMenu('Fruição de folga', 'solicitar', 'Fruição de folga')">Fruição de folga</button>
              <button class="itemSubmenu" onclick="selecionarItemMenu('Extrajornada', 'solicitar', 'Extrajornada')">Extrajornada</button>
            </div>
          </div>

          <div class="itemMenu">
            <button class="botaoItemMenu" onclick="alternarSubmenu('editar')">
              <span>EDITAR</span>
              <img class="seta" src="svg/seta.svg" alt="Seta" width="12" height="12" style="display:block;">
            </button>
            <div class="submenu" id="submenu-editar">
              <button class="itemSubmenu" onclick="selecionarItemMenu('Inserir militar na escala', 'editar', 'Inserir militar na escala')">Inserir militar na escala</button>
              <button class="itemSubmenu" onclick="selecionarItemMenu('Inserir cotas de extrajornadas', 'editar', 'Inserir cotas de extrajornadas')">Inserir cotas de extrajornadas</button>
            </div>
          </div>
        </nav>
      </div>

      <div class="conteudo" id="conteudo">
        <div class="conteudoCabecalho">
          <div class="conteudoCabecalhoTitulo">
            <div class="containerTitulo">
              <div class="tituloClicavel" onclick="alternarDropdownTitulo()">
                <h2 class="titulo" id="tituloTexto">VISUALIZAR</h2>
                <img class="setaTitulo" src="svg/seta.svg" alt="Seta" width="12" height="12" style="display:block;">
              </div>
              <div class="dropdownTitulo" id="dropdownTitulo">
                <div class="campoBusca">
                  <input type="text" id="campoBuscaTitulo" placeholder="Buscar..." onkeyup="filtrarTitulos()">
                </div>
                <div class="listaDropdown" id="listaTitulos"></div>
              </div>
            </div>
            
            <div class="subtituloTexto">
              <div class="subtitulo" id="subtituloTexto">Escalas de serviço</div>
            </div>
            
            <div class="terceiroNivelTexto" id="terceiroNivelContainer" style="display: none;">
              <div class="terceiroNivel" id="terceiroNivelTexto"></div>
            </div>
          </div>
          <div class="conteudoCabecalhoFiltros">
          </div>
        </div>
      </div>
    </div>

    <div id="confirmacaoSairLogout" class="confirmacaoSair-overlay">
      <div class="confirmacaoSair-box">
        <p class="confirmacaoSair-text">Tem certeza que deseja sair?</p>
        <div class="confirmacaoSair-buttons">
          <button class="confirmacaoSair-btn confirmacaoSair-btn-nao" onclick="fecharConfirmacaoSairLogout()">NÃO</button>
          <button class="confirmacaoSair-btn confirmacaoSair-btn-sim" onclick="confirmarLogout()">SIM</button>
        </div>
      </div>
    </div>

    <script>
      function mostrarConfirmacaoSairLogout() {
        document.getElementById('confirmacaoSairLogout').style.display = 'flex';
      }

      function fecharConfirmacaoSairLogout() {
        document.getElementById('confirmacaoSairLogout').style.display = 'none';
      }

      function confirmarLogout() {
        window.location.href = 'index.html';
      }

      function alternarMenu() {
        const menuLateral = document.getElementById('menuLateral');
        const conteudo = document.getElementById('conteudo');

        if (menuLateral.classList.contains('oculto')) {
          menuLateral.classList.remove('oculto');
          conteudo.classList.remove('expandido');
        } else {
          menuLateral.classList.add('oculto');
          conteudo.classList.add('expandido');
          fecharTodosSubmenus();
        }
      }

      function fecharTodosSubmenus() {
        const submenusAbertos = document.querySelectorAll('.submenu.aberto');
        submenusAbertos.forEach(submenu => {
          submenu.classList.remove('aberto');
          const seta = submenu.previousElementSibling.querySelector('.seta');
          if (seta) {
            seta.style.transform = 'rotate(0deg)';
          }
        });
      }

      function alternarSubmenu(submenuId) {
        const submenu = document.getElementById('submenu-' + submenuId);
        const menusProibidos = ['visualizar', 'solicitar', 'editar'];
        
        if (menusProibidos.includes(submenuId)) {
          const menusAbertos = document.querySelectorAll('.submenu.aberto');
          menusAbertos.forEach(menuAberto => {
            if (menuAberto !== submenu) {
              menuAberto.classList.remove('aberto');
              const setaMenuAberto = menuAberto.previousElementSibling.querySelector('.seta');
              if (setaMenuAberto) {
                setaMenuAberto.style.transform = 'rotate(0deg)';
              }
            }
          });
        }
        
        const seta = submenu.previousElementSibling.querySelector('.seta');
        submenu.classList.toggle('aberto');
        seta.style.transform = submenu.classList.contains('aberto') ? 'rotate(180deg)' : 'rotate(0deg)';
      }

      function selecionarItemMenu(texto, menuPrincipal, submenu = '', terceiroNivel = '') {
        atualizarConteudoPeloMenu(menuPrincipal, submenu, terceiroNivel);
      }

      const estruturaMenus = {
        'VISUALIZAR': ['Escalas de serviço', 'Escalas de extrajornada', 'Efetivo', 'Guarnições', 'Viaturas', 'Alterações'],
        'SOLICITAR': ['Troca de serviço', 'Fruição de folga', 'Extrajornada'],
        'EDITAR': ['Inserir militar na escala', 'Inserir cotas de extrajornadas']
      };
      
      const submenusAlteracoes = ['Trocas de serviço', 'Folgas', 'Férias', 'Atestados'];
      
      let menuAtual = 'VISUALIZAR';
      let submenuAtual = 'Escalas de serviço';
      let terceiroNivelAtual = '';

      function alternarDropdownTitulo() {
        const dropdown = document.getElementById('dropdownTitulo');
        const seta = document.querySelector('.setaTitulo');
        
        if (dropdown.classList.contains('aberto')) {
          dropdown.classList.remove('aberto');
          seta.style.transform = 'rotate(0deg)';
        } else {
          fecharTodosDropdowns();
          dropdown.classList.add('aberto');
          seta.style.transform = 'rotate(180deg)';
          preencherListaTitulos();
        }
      }

      function fecharTodosDropdowns() {
        document.getElementById('dropdownTitulo').classList.remove('aberto');
        document.querySelector('.setaTitulo').style.transform = 'rotate(0deg)';
      }

      function preencherListaTitulos() {
        const lista = document.getElementById('listaTitulos');
        lista.innerHTML = '';
        
        Object.keys(estruturaMenus).forEach(menu => {
          const itemCategoria = document.createElement('div');
          itemCategoria.className = 'itemDropdown categoria';
          itemCategoria.textContent = menu;
          lista.appendChild(itemCategoria);
          
          estruturaMenus[menu].forEach(submenu => {
            const itemSubmenu = document.createElement('div');
            itemSubmenu.className = 'itemDropdown subitem';
            itemSubmenu.textContent = submenu;
            if (submenu !== 'Alterações') {
              itemSubmenu.onclick = () => selecionarTituloCompleto(menu, submenu);
            }
            lista.appendChild(itemSubmenu);
            
            if (submenu === 'Alterações') {
              submenusAlteracoes.forEach(subAlteracao => {
                const itemSubAlteracao = document.createElement('div');
                itemSubAlteracao.className = 'itemDropdown subitem';
                itemSubAlteracao.textContent = '  ' + subAlteracao;
                itemSubAlteracao.style.paddingLeft = '3rem';
                itemSubAlteracao.onclick = () => selecionarTituloCompleto(menu, submenu, subAlteracao);
                lista.appendChild(itemSubAlteracao);
              });
            }
          });
        });
      }

      function selecionarTitulo(menu) {
        menuAtual = menu;
        submenuAtual = estruturaMenus[menu][0];
        terceiroNivelAtual = '';
        atualizarTitulos();
        fecharTodosDropdowns();
      }

      function selecionarTituloCompleto(menu, submenu, terceiroNivel = '') {
        menuAtual = menu;
        submenuAtual = submenu;
        terceiroNivelAtual = terceiroNivel;
        atualizarTitulos();
        fecharTodosDropdowns();
      }

      function atualizarTitulos() {
        document.getElementById('tituloTexto').textContent = menuAtual;
        document.getElementById('subtituloTexto').textContent = submenuAtual;
        
        const terceiroContainer = document.getElementById('terceiroNivelContainer');
        const terceiroTexto = document.getElementById('terceiroNivelTexto');
        
        if (terceiroNivelAtual) {
          terceiroTexto.textContent = terceiroNivelAtual;
          terceiroContainer.style.display = 'block';
        } else {
          terceiroContainer.style.display = 'none';
        }
      }

      function filtrarTitulos() {
        const busca = document.getElementById('campoBuscaTitulo').value.toLowerCase();
        const itens = document.querySelectorAll('#listaTitulos .itemDropdown');
        
        itens.forEach(item => {
          if (item.textContent.toLowerCase().includes(busca)) {
            item.style.display = 'block';
          } else {
            item.style.display = 'none';
          }
        });
      }

      function atualizarConteudoPeloMenu(menuId, submenuId = '', terceiroNivel = '') {
        if (menuId === 'visualizar') menuAtual = 'VISUALIZAR';
        else if (menuId === 'solicitar') menuAtual = 'SOLICITAR';
        else if (menuId === 'editar') menuAtual = 'EDITAR';
        
        if (submenuId === 'alteracoes') {
          submenuAtual = 'Alterações';
          terceiroNivelAtual = terceiroNivel || '';
        } else {
          submenuAtual = submenuId || estruturaMenus[menuAtual][0];
          terceiroNivelAtual = terceiroNivel || '';
        }
        
        atualizarTitulos();
      }

      document.addEventListener('click', function(event) {
        if (!event.target.closest('.tituloClicavel') && !event.target.closest('.dropdownTitulo')) {
          document.getElementById('dropdownTitulo').classList.remove('aberto');
          document.querySelector('.setaTitulo').style.transform = 'rotate(0deg)';
        }
      });
    </script>
  </body>
</html>